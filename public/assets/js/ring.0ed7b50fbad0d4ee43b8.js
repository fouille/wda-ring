(()=>{"use strict";var e={7:e=>{var t,s="object"==typeof Reflect?Reflect:null,i=s&&"function"==typeof s.apply?s.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)};t=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(s,i){function n(s){e.removeListener(t,o),i(s)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",n),s([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t,s){"function"==typeof e.on&&f(e,"error",t,{once:!0})}(e,n)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function r(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function h(e,t,s,i){var n,o,a,h;if(r(s),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,s.listener?s.listener:s),o=e._events),a=o[t]),void 0===a)a=o[t]=s,++e._eventsCount;else if("function"==typeof a?a=o[t]=i?[s,a]:[a,s]:i?a.unshift(s):a.push(s),(n=l(e))>0&&a.length>n&&!a.warned){a.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=a.length,h=d,console&&console.warn&&console.warn(h)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,s){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:s},n=d.bind(i);return n.listener=s,i.wrapFn=n,n}function u(e,t,s){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?s?[n.listener||n]:[n]:s?function(e){for(var t=new Array(e.length),s=0;s<t.length;++s)t[s]=e[s].listener||e[s];return t}(n):p(n,n.length)}function g(e){var t=this._events;if(void 0!==t){var s=t[e];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function p(e,t){for(var s=new Array(t),i=0;i<t;++i)s[i]=e[i];return s}function f(e,t,s,i){if("function"==typeof e.on)i.once?e.once(t,s):e.on(t,s);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(o){i.once&&e.removeEventListener(t,n),s(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var r=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw r.context=a,r}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var h=l.length,d=p(l,h);for(s=0;s<h;++s)i(d[s],this,t)}return!0},o.prototype.addListener=function(e,t){return h(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return h(this,e,t,!0)},o.prototype.once=function(e,t){return r(t),this.on(e,c(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return r(t),this.prependListener(e,c(this,e,t)),this},o.prototype.removeListener=function(e,t){var s,i,n,o,a;if(r(t),void 0===(i=this._events))return this;if(void 0===(s=i[e]))return this;if(s===t||s.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,s.listener||t));else if("function"!=typeof s){for(n=-1,o=s.length-1;o>=0;o--)if(s[o]===t||s[o].listener===t){a=s[o].listener,n=o;break}if(n<0)return this;0===n?s.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(s,n),1===s.length&&(i[e]=s[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,s,i;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[e]),this;if(0===arguments.length){var n,o=Object.keys(s);for(i=0;i<o.length;++i)"removeListener"!==(n=o[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=s[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return u(this,e,!0)},o.prototype.rawListeners=function(e){return u(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},o.prototype.listenerCount=g,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var i={};(()=>{s.d(i,{y:()=>ee});const e="wazo/EVENT_APP_INITIALIZE",t="wazo/mobile/EVENT_MOBILE_ON_MENU_ACTION";class n{constructor(){if(this.onNewSession=e=>{},this.onUnLoaded=e=>{},this.onPluginUnLoaded=()=>{},this.onAppUnLoaded=e=>{},this.onIframeMessage=e=>{},this.onBackgroundMessage=e=>{},this.onLogout=()=>{},this.onCallIncoming=e=>{},this.onCallMade=e=>{},this.onCallAnswered=e=>{},this.onCallAccepted=e=>{},this.onCallHungUp=e=>{},this.onUnHandledEvent=e=>{},this.onWebsocketMessage=e=>{},this.onMeetingCreated=e=>{},this.onRouteChanged=(e,t)=>{},this.onUserJoinRoom=e=>{},this.onUserLeaveRoom=e=>{},this.onParticipantJoinRoom=(e,t)=>{},this.onParticipantLeaveRoom=(e,t)=>{},this.onConnectedToStack=e=>{},this.onSwitchTenant=(e,t)=>{},this.initialize=async()=>this.isInitialized()?Promise.resolve():(window.addEventListener("message",this._onMessage,!1),new Promise(((t,s)=>{this._sendMessage(e,{bg:this._isBackground,pluginId:this._pluginId}),this._initializeTimeout=setTimeout((()=>{this._initializeTimeout=null,s("SDK initialize timeout")}),5e3),this._initializeResolve=t}))),this.isInitialized=()=>this._initializeCompleted,this.getContext=()=>this.context,this.sendMessageToIframe=e=>this._sendMessage("wazo/EVENT_SEND_IFRAME_MESSAGE",{payload:e}),this.sendMessageToBackground=e=>this._sendMessage("wazo/EVENT_SEND_BACKGROUND_MESSAGE",{payload:e}),this.startCall=({targets:e,requestedModalities:t=["audio"]})=>{this._sendMessage("wazo/START_CALL",{targets:e,requestedModalities:t})},this.openLink=e=>{this._sendMessage("wazo/EVENT_OPEN_LINK",{url:e})},this.createMeeting=(e,t=!1,s=!1)=>{this._sendMessage("wazo/EVENT_CREATE_MEETING",{name:e,requireAuthorization:t,persistent:s})},this.openMeetingLobby=e=>{this._sendMessage("wazo/EVENT_OPEN_MEETING_LOBBY",{extension:e})},this.openSettings=()=>{},this.closeLeftPanel=()=>this._sendMessage("wazo/EVENT_CLOSE_LEFT_PANEL"),this.openLeftPanel=()=>this._sendMessage("wazo/EVENT_OPEN_LEFT_PANEL"),this.playProgressSound=()=>this._sendMessage("wazo/EVENT_PLAY_PROGRESS_SOUND"),this.playNewMessageSound=()=>this._sendMessage("wazo/EVENT_PLAY_NEW_MESSAGE_SOUND"),this.playIncomingCallSound=()=>this._sendMessage("wazo/EVENT_PLAY_INCOMING_CALL_SOUND"),this.playDoubleCallSound=()=>this._sendMessage("wazo/EVENT_PLAY_DOUBLE_CALL_SOUND"),this.playHangupSound=()=>this._sendMessage("wazo/EVENT_PLAY_HANGUP_SOUND"),this.stopCurrentSound=()=>this._sendMessage("wazo/EVENT_STOP_CURRENT_SOUND"),this.configureSounds=e=>this._sendMessage("wazo/EVENT_CONFIGURE_SOUNDS",{sounds:e}),this.resetSounds=()=>this._sendMessage("wazo/EVENT_RESET_SOUNDS"),this.changeNavBarColor=e=>this._sendMessage("wazo/EVENT_CHANGE_NAVBAR_COLOR",{color:e}),this.resetNavBarColor=()=>this._sendMessage("wazo/EVENT_RESET_NAVBAR_COLOR"),this.displayNotification=(e,t)=>this._sendMessage("wazo/EVENT_DISPLAY_NOTIFICATION",{title:e,text:t}),this.displayModal=({url:e,title:t,text:s,htmlText:i,height:n,width:o})=>this._sendMessage("wazo/EVENT_DISPLAY_MODAL",{url:e,title:t,text:s,htmlText:i,height:n,width:o}),this.removeModal=()=>this._sendMessage("wazo/EVENT_REMOVE_MODAL"),this.hasLocalVideoStream=e=>Wazo.Phone.phone.hasALocalVideoTrack(e),this.getLocalCurrentVideoStream=e=>Wazo.Phone.phone.getLocalVideoStream(e),this.hasRemoveVideoStream=e=>Wazo.Phone.phone.hasRemoteVideo(e),this.getRemoteVideoStream=e=>Wazo.Phone.phone.getRemoteVideoStream(e),this.updateBadge=e=>this._sendMessage("wazo/EVENT_UPDATE_BADGE",{...e,entityId:e.entityId||this._entityId||"update-badge-null-entity-id"}),this.changeToolbarDisplay=e=>this._sendMessage("wazo/EVENT_CHANGE_TOOLBAR_DISPLAY",{display:e}),this.setMobileHeader=({title:e,callback:t},s)=>{const i=s||this._entityId;i&&(delete this._headerBackCallbacks[i],"function"==typeof t&&(this._headerBackCallbacks[i]=t)),this._sendMessage("wazo/mobile/EVENT_MOBILE_HEADER",{headerTitle:e,emitHeaderBack:!!t,entityId:s||this._entityId})},this.setMobileContextualMenu=(e,t)=>this._sendMessage("wazo/mobile/EVENT_MOBILE_CONTEXTUAL_MENU",{contextualMenu:e,entityId:t||this._entityId}),this.setMobileShowBottomNav=(e,t)=>this._sendMessage("wazo/mobile/EVENT_MOBILE_SHOW_BOTTOM_NAV",{showBottomNav:e,entityId:t||this._entityId}),this.onMobileMenuAction=e=>this.sendMessageToIframe({type:t,id:e}),this._onMessage=e=>{if(e.data)switch(e.data.type){case"wazo/ON_LOADED":this._onLoaded(e.data.session,e.data.theme,e.data.locale,e.data.extra);break;case"wazo/EVENT_APP_UNLOADED":delete this._headerBackCallbacks[e.data.tabId],this.onAppUnLoaded(e.data.tabId);break;case"wazo/EVENT_PLUGIN_UNLOADED":this._unloadPlugin();break;case"wazo/EVENT_ON_LOGOUT":this.onLogout(),this._unloadPlugin();break;case"wazo/EVENT_ON_NEW_SESSION":this.onNewSession(e.data.session);break;case"wazo/EVENT_ON_IFRAME_MESSAGE":e.data._pluginId===this._pluginId&&this.onIframeMessage(e.data.payload);break;case"wazo/EVENT_ON_BACKGROUND_MESSAGE":e.data._pluginId===this._pluginId&&this.onBackgroundMessage(e.data.payload);break;case"wazo/EVENT_USER_JOIN_ROOM":this.onUserJoinRoom(e.data.room);break;case"wazo/EVENT_USER_LEAVE_ROOM":this.onUserLeaveRoom(e.data.room);break;case"wazo/EVENT_PARTICIPANT_JOIN_ROOM":this.onParticipantJoinRoom(e.data.room,e.data.participant);break;case"wazo/EVENT_PARTICIPANT_LEAVE_ROOM":this.onParticipantLeaveRoom(e.data.room,e.data.participant);break;case"wazo/EVENT_WS_MESSAGE":this.onWebsocketMessage(e.data.message);break;case"wazo/EVENT_ON_MEETING_CREATED":this.onMeetingCreated(e.data.meeting);break;case"wazo/EVENT_ROUTE_CHANGE":this.onRouteChanged(e.data.location,e.data.action);break;case"wazo/EVENT_ON_CALL_INCOMING":this.onCallIncoming(e.data.call);break;case"wazo/EVENT_ON_CALL_MADE":this.onCallMade(e.data.call);break;case"wazo/EVENT_ON_CALL_ANSWERED":this.onCallAnswered(e.data.call);break;case"wazo/EVENT_ON_CALL_ACCEPTED":this.onCallAccepted(e.data.call);break;case"wazo/EVENT_ON_CALL_HUNG_UP":this.onCallHungUp(e.data.call);break;case"wazo/EVENT_ON_CONNECTED_TO_STACK":this.onConnectedToStack(e.data.stackSession);break;case"wazo/EVENT_ON_SWITCH_STACK_TENANT":this.onSwitchTenant(e.data.tenant.uuid,e.data.tenant.name);break;case"wazo/mobile/EVENT_MOBILE_ON_HEADER_BACK":const s=this._headerBackCallbacks[e.data.entityId||this._entityId];"function"==typeof s&&s();break;case t:this.onMobileMenuAction(e.data);break;default:this.onUnHandledEvent(e)}},this._sendMessage=(t,s={})=>{if(this.isInitialized()||t===e)return window.ReactNativeWebView?window.ReactNativeWebView.postMessage(JSON.stringify({type:t,_pluginId:this._pluginId,_entityId:this._entityId,...s})):void window.parent.postMessage({type:t,_pluginId:this._pluginId,_entityId:this._entityId,...s},"*");this._queuedMessages.push({type:t,payload:s})},this._sendQueuedMessages=()=>{this._queuedMessages.forEach((({type:e,payload:t})=>{this._sendMessage(e,t)}))},this._onLoaded=(e,t,s,i)=>{null===this._initializeTimeout||this.isInitialized()||(clearTimeout(this._initializeTimeout),this._initializeCompleted=!0,this.context.app={locale:s,theme:t,host:{clientType:i?i.clientType:null},extra:{...i,baseUrl:this._baseUrl,pluginId:this._pluginId}},this.context.user=e,this._initializeResolve&&this._initializeResolve(),this._sendQueuedMessages())},this._setPluginId=e=>{this._pluginId=e},this._unloadPlugin=()=>{this.onPluginUnLoaded(),this._resetEvents()},this._configurePlugin=e=>{e.pluginId&&(this._pluginId=e.pluginId),e.baseUrl&&(this._baseUrl=e.baseUrl),e.entityId&&(this._entityId=e.entityId)},this._resetEvents=()=>{this.onUnLoaded=e=>{},this.onPluginUnLoaded=()=>{},this.onAppUnLoaded=e=>{},this.onIframeMessage=e=>{},this.onBackgroundMessage=e=>{},this.onLogout=()=>{},this.onNewSession=e=>{},this.onCallIncoming=e=>{},this.onCallMade=e=>{},this.onCallAnswered=e=>{},this.onCallAccepted=e=>{},this.onCallHungUp=e=>{},this.onUnHandledEvent=e=>{},this.onWebsocketMessage=e=>{},this.onMeetingCreated=e=>{},this.onRouteChanged=(e,t)=>{},this.onConnectedToStack=e=>{},this.onSwitchTenant=(e,t)=>{}},this._resetEvents(),this._initializeCompleted=!1,this._initializeResolve=null,this._initializeTimeout=null,this._pluginId=null,this._baseUrl=null,this._entityId=null,this._isBackground=!window.name,this._queuedMessages=[],this._headerBackCallbacks={},this.context={app:{locale:null,theme:null,host:{clientType:null},extra:null}},window.onunload=e=>{this.onUnLoaded(e)},window.name)try{this._configurePlugin(JSON.parse(window.name))}catch(e){this._configurePlugin({pluginId:window.name})}globalThis._setPluginId=this._setPluginId,globalThis._configurePlugin=this._configurePlugin}ignoreCall(e){this._sendMessage("wazo/EVENT_IGNORE_CALL",{call:e})}}new n;var o=s(7),a=s.n(o);const r="bridge/CONFIG_RETRIEVED";class l extends(a()){constructor(){super(...arguments),this.url="https://softphone.wazo.io",this.width=500,this.height=600,this.iframeCss={left:0,bottom:0},this.displayed=!1,this.wrapper=null,this.iframe=null,this.iframeLoaded=!1,this.session=null,this._pendingMessages=[]}onLinkEnabled(e){}onIFrameLoaded(){}onCallLocallyAnswered(e){}onCallEstablished(e){}onOutgoingCallMade(e){}onCallIncoming(e){}onCallRejected(e){}onCallEnded(e,t,s,i){}onCardSaved(e){}onCardCanceled(){}onAuthenticated(e){}onLoggedOut(){}onSearchOptions(e,t){this.onOptionsResults(e,[])}onDisplayLinkedOption(e){}onWazoContactSearch(e){}onAgentLoggedIn(){}onAgentLoggedOut(){}onAgentPaused(){}onAgentResumed(){}onLanguageChanged(e){}onCallHeld(){}onCallResumed(){}onCallMuted(){}onCallUnMuted(){}onDtmfSent(e){}onDirectTransfer(e){}onCreateIndirectTransfer(e){}onCancelIndirectTransfer(){}onConfirmIndirectTransfer(){}onIndirectCallMade(e){}onIndirectTransferDone(e){}onStartRecording(){}onStopRecording(){}onCallLogCreated(e){}onWebsocketMessage(e){}onUnHandledEvent(e){}init({url:e,width:t,height:s,server:i,port:n,language:o,wrapUpDuration:a,iframeCss:l,enableAgent:h=!0,tenantId:d,domainName:c,debug:u=!1,disableAutoLogin:g=!1}){if(this.url=e||this.url,this.width=t||this.width,this.height=s||this.height,this.iframeCss=l||this.iframeCss,this.displayed=!1,this.iframeLoaded=!1,this.iframeLoaded=!1,this._pendingMessages=[],window.addEventListener("message",this._onMessage.bind(this),!1),!i)throw new Error("`server` is not set");const p={server:i,disableAutoLogin:g};o&&(p.language=o),n&&(p.port=n),d&&(console.warn("Use of `tenantId` is deprecated when calling `Softphone.init()`, use `domainName` instead"),p.tenantId=d),c&&(p.domainName=c),a&&(p.wrapUpDuration=a),this._sendMessage(r,{config:p}),h&&this._sendMessage("bridge/BRIDGE_ENABLE_AGENT"),u&&this._sendMessage("bridge/BRIDGE_ENABLE_DEBUG"),this._createIframe((()=>{this.iframeLoaded=!0,this._pendingMessages.forEach((([e,t])=>this._sendMessage(e,t))),this.onIFrameLoaded()}))}parseLinks(){this._getLinks().forEach((e=>{e.setAttribute("data-wazo-parsed","true"),e.addEventListener("click",this._onLinkClick.bind(this)),this.onLinkEnabled(e)}))}removeParsedLinksEvent(){[].slice.call(document.querySelectorAll("a[data-wazo-parsed]"),0).forEach((e=>{e.removeAttribute("data-wazo-parsed"),e.removeEventListener("click",this._onLinkClick.bind(this))}))}makeCall(e){this.show(),this._sendMessage("bridge/ON_CLICK_TO_CALL",{number:e})}toggleDisplay(){this.displayed?this.hide():this.show()}show(){this.iframe||this._createIframe(),this.iframe&&(this.iframe.style.display="block"),this.displayed=!0,this.emit("show")}hide(){this.iframe&&(this.iframe.style.display="none"),this.displayed=!1,this.emit("hide")}remove(){this.iframe&&this.iframe.remove(),this.wrapper&&this.wrapper.remove(),this.iframe=null,this.wrapper=null}optionsFetched(e,t){this._sendMessage("bridge/BRIDGE_OPTIONS_FETCHED",{fieldId:e,options:t})}onOptionsResults(e,t){this._sendMessage("bridge/BRIDGE_OPTIONS_FOUND",{fieldId:e,options:t})}setFormSchema(e,t){this._sendMessage("bridge/BRIDGE_UPDATE_FORM_SCHEMA",{schema:e,uiSchema:t})}setCardValue(e,t){this._sendMessage("bridge/BRIDGE_SET_CARD_CONTENT",{field:e,value:t})}injectCss(e){this._sendMessage("bridge/BRIDGE_INJECT_CSS",{css:e})}customizeAppearance(e,t,s){this._sendMessage("bridge/BRIDGE_CUSTOMIZE_APPEARANCE",{themes:e,translations:t,assets:s})}loginWithToken(e,t){this._sendMessage("bridge/BRIDGE_LOGIN_WITH_TOKEN",{token:e,refreshToken:t})}configureServer(e){this._sendMessage(r,{config:{server:e}})}updateCss(e=null){e&&(this.wrapper&&Object.keys(e).forEach((t=>{this.wrapper.style[t]=e[t]})),this.iframeCss=e)}_createIframe(e){this.remove(),this.wrapper=document.createElement("div"),this.wrapper.id="iframe-wrapper",this.wrapper.style.position="fixed",this.updateCss(this.iframeCss),this.iframe=document.createElement("iframe"),this.iframe.width=String(this.width),this.iframe.height=String(this.height),this.iframe.allow="camera *; microphone *; autoplay *; display-capture *",this.iframe.style.border="1px solid #aaa",this.iframe.style.backgroundColor="white",this.iframe.style.display="none",this.iframe.src=this.url,this.iframe.id="wazo-softphone",e&&(this.iframe.onload=e),this.wrapper.appendChild(this.iframe),document.body.appendChild(this.wrapper)}_getLinks(){return[].slice.call(document.querySelectorAll("a:not([data-wazo-parsed])"),0).filter((e=>0===e.href.indexOf("tel:")||0===e.href.indexOf("callto:")))}_onLinkClick(e){e.preventDefault();const t=e.target.href.split("//")[1];this.makeCall(t)}_onAuthenticated(e){this.session=e,this.parseLinks()}_onMessage(e){if(e.data)switch(e.data.type){case"sdk/SDK_ON_OUTGOING_CALL_MADE":this.onOutgoingCallMade(e.data.callSession);break;case"sdk/ON_CALL_ENDED":{const{callSession:t,content:s,direction:i,userExtension:n}=e.data;this.onCallEnded(t,s,i,n);break}case"sdk/SDK_CALL_INCOMING":this.onCallIncoming(e.data.callSession);break;case"sdk/SDK_AUTHENTICATED":this._onAuthenticated(e.data.session),this.onAuthenticated(e.data.session);break;case"bridge/LOGGED_OUT":this.onLoggedOut();break;case"bridge/BRIDGE_CREATE_OR_UPDATE_CARD":{const{content:t}=e.data;this.onCardSaved(t);break}case"bridge/BRIDGE_SEARCH_OPTIONS":{const{fieldId:t,query:s}=e.data;this.onSearchOptions(t,s);break}case"bridge/DISPLAY_LINKED_OPTION":this.onDisplayLinkedOption(e.data.linkedOptionId);break;case"bridge/BRIDGE_WAZO_CONTACT_SEARCH":this.onWazoContactSearch(e.data.query);break;case"bridge/BRIDGE_ON_AGENT_LOGGED_IN":this.onAgentLoggedIn();break;case"bridge/BRIDGE_ON_AGENT_LOGGED_OUT":this.onAgentLoggedOut();break;case"bridge/BRIDGE_ON_AGENT_PAUSED":this.onAgentPaused();break;case"bridge/BRIDGE_ON_AGENT_RESUMED":this.onAgentResumed();break;case"bridge/BRIDGE_ON_LANGUAGE_CHANGED":this.onLanguageChanged(e.data.language);break;case"bridge/BRIDGE_ON_CALL_HELD":this.onCallHeld();break;case"bridge/BRIDGE_ON_CALL_RESUMED":this.onCallResumed();break;case"bridge/BRIDGE_ON_CALL_MUTED":this.onCallMuted();break;case"bridge/BRIDGE_ON_CALL_UN_MUTED":this.onCallUnMuted();break;case"bridge/BRIDGE_ON_DTMF":this.onDtmfSent(e.data.tone);break;case"bridge/BRIDGE_ON_DIRECT_TRANSFER":this.onDirectTransfer(e.data.number);break;case"bridge/BRIDGE_ON_CREATE_INDIRECT_TRANSFER":this.onCreateIndirectTransfer(e.data.number);break;case"bridge/BRIDGE_ON_CANCEL_INDIRECT_TRANSFER":this.onCancelIndirectTransfer();break;case"bridge/BRIDGE_ON_CONFIRM_INDIRECT_TRANSFER":this.onConfirmIndirectTransfer();break;case"bridge/BRIDGE_ON_INDIRECT_TRANSFER_CALL_MADE":this.onIndirectCallMade(e.data.call);break;case"bridge/BRIDGE_ON_INDIRECT_TRANSFER_DONE":this.onIndirectTransferDone(e.data.call);break;case"bridge/BRIDGE_ON_START_RECORDING":this.onStartRecording();break;case"bridge/BRIDGE_ON_STOP_RECORDING":this.onStopRecording();break;case"bridge/BRIDGE_ON_CARD_CANCELED":this.onCardCanceled();break;case"bridge/BRIDGE_ON_CALL_LOCALLY_ACCEPTED":this.onCallLocallyAnswered(e.data.call);break;case"bridge/BRIDGE_ON_CALL_REJECTED":this.onCallRejected(e.data.call);break;case"bridge/BRIDGE_ON_CALL_ESTABLISHED":this.onCallEstablished(e.data.call);break;case"bridge/BRIDGE_CALL_LOG_CREATED":this.onCallLogCreated(e.data.callLog);break;case"bridge/BRIDGE_ON_WEBSOCKET_MESSAGE":this.onWebsocketMessage(e.data.message);break;default:this.onUnHandledEvent(e)}}_sendMessage(e,t={}){this.iframe&&this.iframeLoaded?this.iframe&&this.iframe.contentWindow&&this.iframe.contentWindow.postMessage({type:e,...t},"*"):this._pendingMessages.push([e,t])}}new l;const h={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||h,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,s,i){return i&&!this.debug?null:("string"==typeof e[0]&&(e[0]=`${s}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new d(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new d(this.logger,e)}}var c=new d;class u{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const s=this.observers[e].get(t)||0;this.observers[e].set(t,s+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach((e=>{let[t,i]=e;for(let e=0;e<i;e++)t(...s)})),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach((t=>{let[i,n]=t;for(let t=0;t<n;t++)i.apply(i,[e,...s])}))}}function g(){let e,t;const s=new Promise(((s,i)=>{e=s,t=i}));return s.resolve=e,s.reject=t,s}function p(e){return null==e?"":""+e}const f=/###/g;function m(e,t,s){function i(e){return e&&e.indexOf("###")>-1?e.replace(f,"."):e}function n(){return!e||"string"==typeof e}const o="string"!=typeof t?t:t.split(".");let a=0;for(;a<o.length-1;){if(n())return{};const t=i(o[a]);!e[t]&&s&&(e[t]=new s),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++a}return n()?{}:{obj:e,k:i(o[a])}}function y(e,t,s){const{obj:i,k:n}=m(e,t,Object);if(void 0!==i||1===t.length)return void(i[n]=s);let o=t[t.length-1],a=t.slice(0,t.length-1),r=m(e,a,Object);for(;void 0===r.obj&&a.length;)o=`${a[a.length-1]}.${o}`,a=a.slice(0,a.length-1),r=m(e,a,Object),r&&r.obj&&void 0!==r.obj[`${r.k}.${o}`]&&(r.obj=void 0);r.obj[`${r.k}.${o}`]=s}function b(e,t){const{obj:s,k:i}=m(e,t);if(s)return s[i]}function _(e,t,s){for(const i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?"string"==typeof e[i]||e[i]instanceof String||"string"==typeof t[i]||t[i]instanceof String?s&&(e[i]=t[i]):_(e[i],t[i],s):e[i]=t[i]);return e}function v(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function L(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(e=>E[e])):e}const N=[" ",",","?","!",";"],S=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const s=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,s),this.regExpQueue.push(e),s}}(20);function O(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t])return e[t];const i=t.split(s);let n=e;for(let e=0;e<i.length;){if(!n||"object"!=typeof n)return;let t,o="";for(let a=e;a<i.length;++a)if(a!==e&&(o+=s),o+=i[a],t=n[o],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<i.length-1)continue;e+=a-e+1;break}n=t}return n}function w(e){return e&&e.indexOf("_")>0?e.replace("_","-"):e}class k extends u{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,o=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,t],s&&(Array.isArray(s)?a.push(...s):"string"==typeof s&&n?a.push(...s.split(n)):a.push(s)));const r=b(this.data,a);return!r&&!t&&!s&&e.indexOf(".")>-1&&(e=a[0],t=a[1],s=a.slice(2).join(".")),r||!o||"string"!=typeof s?r:O(this.data&&this.data[e]&&this.data[e][t],s,n)}addResource(e,t,s,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const o=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator;let a=[e,t];s&&(a=a.concat(o?s.split(o):s)),e.indexOf(".")>-1&&(a=e.split("."),i=t,t=a[1]),this.addNamespaces(t),y(this.data,a,i),n.silent||this.emit("added",e,t,s,i)}addResources(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const i in s)"string"!=typeof s[i]&&"[object Array]"!==Object.prototype.toString.apply(s[i])||this.addResource(e,t,i,s[i],{silent:!0});i.silent||this.emit("added",e,t,s)}addResourceBundle(e,t,s,i,n){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),i=s,s=t,t=a[1]),this.addNamespaces(t);let r=b(this.data,a)||{};o.skipCopy||(s=JSON.parse(JSON.stringify(s))),i?_(r,s,n):r={...r,...s},y(this.data,a,r),o.silent||this.emit("added",e,t,s)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var C={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,s,i,n){return e.forEach((e=>{this.processors[e]&&(t=this.processors[e].process(t,s,i,n))})),t}};const x={};class R extends u{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i;super(),s=e,i=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((e=>{s[e]&&(i[e]=s[e])})),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=c.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;const s=this.resolve(e,t);return s&&void 0!==s.res}extractFromKey(e,t){let s=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===s&&(s=":");const i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let n=t.ns||this.options.defaultNS||[];const o=s&&e.indexOf(s)>-1,a=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,s){t=t||"",s=s||"";const i=N.filter((e=>t.indexOf(e)<0&&s.indexOf(e)<0));if(0===i.length)return!0;const n=S.getRegExp(`(${i.map((e=>"?"===e?"\\?":e)).join("|")})`);let o=!n.test(e);if(!o){const t=e.indexOf(s);t>0&&!n.test(e.substring(0,t))&&(o=!0)}return o}(e,s,i));if(o&&!a){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:n};const o=e.split(s);(s!==i||s===i&&this.options.ns.indexOf(o[0])>-1)&&(n=o.shift()),e=o.join(i)}return"string"==typeof n&&(n=[n]),{key:e,namespaces:n}}translate(e,t,s){if("object"!=typeof t&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof t&&(t={...t}),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const i=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,{key:o,namespaces:a}=this.extractFromKey(e[e.length-1],t),r=a[a.length-1],l=t.lng||this.language,h=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(h){const e=t.nsSeparator||this.options.nsSeparator;return i?{res:`${r}${e}${o}`,usedKey:o,exactUsedKey:o,usedLng:l,usedNS:r,usedParams:this.getUsedParamsDetails(t)}:`${r}${e}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:l,usedNS:r,usedParams:this.getUsedParamsDetails(t)}:o}const d=this.resolve(e,t);let c=d&&d.res;const u=d&&d.usedKey||o,g=d&&d.exactUsedKey||o,p=Object.prototype.toString.apply(c),f=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject;if(m&&c&&"string"!=typeof c&&"boolean"!=typeof c&&"number"!=typeof c&&["[object Number]","[object Function]","[object RegExp]"].indexOf(p)<0&&("string"!=typeof f||"[object Array]"!==p)){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(u,c,{...t,ns:a}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(d.res=e,d.usedParams=this.getUsedParamsDetails(t),d):e}if(n){const e="[object Array]"===p,s=e?[]:{},i=e?g:u;for(const e in c)if(Object.prototype.hasOwnProperty.call(c,e)){const o=`${i}${n}${e}`;s[e]=this.translate(o,{...t,joinArrays:!1,ns:a}),s[e]===o&&(s[e]=c[e])}c=s}}else if(m&&"string"==typeof f&&"[object Array]"===p)c=c.join(f),c&&(c=this.extendTranslation(c,e,t,s));else{let i=!1,a=!1;const h=void 0!==t.count&&"string"!=typeof t.count,u=R.hasDefaultValue(t),g=h?this.pluralResolver.getSuffix(l,t.count,t):"",p=t.ordinal&&h?this.pluralResolver.getSuffix(l,t.count,{ordinal:!1}):"",f=h&&!t.ordinal&&0===t.count&&this.pluralResolver.shouldUseIntlApi(),m=f&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${g}`]||t[`defaultValue${p}`]||t.defaultValue;!this.isValidLookup(c)&&u&&(i=!0,c=m),this.isValidLookup(c)||(a=!0,c=o);const y=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:c,b=u&&m!==c&&this.options.updateMissing;if(a||i||b){if(this.logger.log(b?"updateKey":"missingKey",l,r,o,b?m:c),n){const e=this.resolve(o,{...t,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const s=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&s&&s[0])for(let t=0;t<s.length;t++)e.push(s[t]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(t.lng||this.language):e.push(t.lng||this.language);const i=(e,s,i)=>{const n=u&&i!==c?i:y;this.options.missingKeyHandler?this.options.missingKeyHandler(e,r,s,n,b,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(e,r,s,n,b,t),this.emit("missingKey",e,r,s,c)};this.options.saveMissing&&(this.options.saveMissingPlurals&&h?e.forEach((e=>{const s=this.pluralResolver.getSuffixes(e,t);f&&t[`defaultValue${this.options.pluralSeparator}zero`]&&s.indexOf(`${this.options.pluralSeparator}zero`)<0&&s.push(`${this.options.pluralSeparator}zero`),s.forEach((s=>{i([e],o+s,t[`defaultValue${s}`]||m)}))})):i(e,o,m))}c=this.extendTranslation(c,e,t,d,s),a&&c===o&&this.options.appendNamespaceToMissingKey&&(c=`${r}:${o}`),(a||i)&&this.options.parseMissingKeyHandler&&(c="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${r}:${o}`:o,i?c:void 0):this.options.parseMissingKeyHandler(c))}return i?(d.res=c,d.usedParams=this.getUsedParamsDetails(t),d):c}extendTranslation(e,t,s,i,n){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const a="string"==typeof e&&(s&&s.interpolation&&void 0!==s.interpolation.skipOnVariables?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let r;if(a){const t=e.match(this.interpolator.nestingRegexp);r=t&&t.length}let l=s.replace&&"string"!=typeof s.replace?s.replace:s;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),e=this.interpolator.interpolate(e,l,s.lng||this.language,s),a){const t=e.match(this.interpolator.nestingRegexp);r<(t&&t.length)&&(s.nest=!1)}!s.lng&&"v1"!==this.options.compatibilityAPI&&i&&i.res&&(s.lng=i.usedLng),!1!==s.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return n&&n[0]===i[0]&&!s.context?(o.logger.warn(`It seems you are nesting recursively key: ${i[0]} in key: ${t[0]}`),null):o.translate(...i,t)}),s)),s.interpolation&&this.interpolator.reset()}const a=s.postProcess||this.options.postProcess,r="string"==typeof a?[a]:a;return null!=e&&r&&r.length&&!1!==s.applyPostProcessor&&(e=C.handle(r,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),e}resolve(e){let t,s,i,n,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(t))return;const r=this.extractFromKey(e,a),l=r.key;s=l;let h=r.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const d=void 0!==a.count&&"string"!=typeof a.count,c=d&&!a.ordinal&&0===a.count&&this.pluralResolver.shouldUseIntlApi(),u=void 0!==a.context&&("string"==typeof a.context||"number"==typeof a.context)&&""!==a.context,g=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);h.forEach((e=>{this.isValidLookup(t)||(o=e,!x[`${g[0]}-${e}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(x[`${g[0]}-${e}`]=!0,this.logger.warn(`key "${s}" for languages "${g.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach((s=>{if(this.isValidLookup(t))return;n=s;const o=[l];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(o,l,s,e,a);else{let e;d&&(e=this.pluralResolver.getSuffix(s,a.count,a));const t=`${this.options.pluralSeparator}zero`,i=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(o.push(l+e),a.ordinal&&0===e.indexOf(i)&&o.push(l+e.replace(i,this.options.pluralSeparator)),c&&o.push(l+t)),u){const s=`${l}${this.options.contextSeparator}${a.context}`;o.push(s),d&&(o.push(s+e),a.ordinal&&0===e.indexOf(i)&&o.push(s+e.replace(i,this.options.pluralSeparator)),c&&o.push(s+t))}}let r;for(;r=o.pop();)this.isValidLookup(t)||(i=r,t=this.getResource(s,e,r,a))})))}))})),{res:t,usedKey:s,exactUsedKey:i,usedLng:n,usedNS:o}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,s,i):this.resourceStore.getResource(e,t,s,i)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=e.replace&&"string"!=typeof e.replace;let i=s?e.replace:e;if(s&&void 0!==e.count&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!s){i={...i};for(const e of t)delete i[e]}return i}static hasDefaultValue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}function I(e){return e.charAt(0).toUpperCase()+e.slice(1)}class T{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=c.create("languageUtils")}getScriptPartFromCode(e){if(!(e=w(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=w(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if("string"==typeof e&&e.indexOf("-")>-1){const t=["hans","hant","latn","cyrl","cans","mong","arab"];let s=e.split("-");return this.options.lowerCaseLng?s=s.map((e=>e.toLowerCase())):2===s.length?(s[0]=s[0].toLowerCase(),s[1]=s[1].toUpperCase(),t.indexOf(s[1].toLowerCase())>-1&&(s[1]=I(s[1].toLowerCase()))):3===s.length&&(s[0]=s[0].toLowerCase(),2===s[1].length&&(s[1]=s[1].toUpperCase()),"sgn"!==s[0]&&2===s[2].length&&(s[2]=s[2].toUpperCase()),t.indexOf(s[1].toLowerCase())>-1&&(s[1]=I(s[1].toLowerCase())),t.indexOf(s[2].toLowerCase())>-1&&(s[2]=I(s[2].toLowerCase()))),s.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const s=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(s)||(t=s)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const s=this.getLanguagePartFromCode(e);if(this.isSupportedCode(s))return t=s;t=this.options.supportedLngs.find((e=>e===s?e:e.indexOf("-")<0&&s.indexOf("-")<0?void 0:e.indexOf("-")>0&&s.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===s||0===e.indexOf(s)&&s.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];let s=e[t];return s||(s=e[this.getScriptPartFromCode(t)]),s||(s=e[this.formatLanguageCode(t)]),s||(s=e[this.getLanguagePartFromCode(t)]),s||(s=e.default),s||[]}toResolveHierarchy(e,t){const s=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],n=e=>{e&&(this.isSupportedCode(e)?i.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return"string"==typeof e&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(e))):"string"==typeof e&&n(this.formatLanguageCode(e)),s.forEach((e=>{i.indexOf(e)<0&&n(this.formatLanguageCode(e))})),i}}let A=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],M={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}};const P=["v1","v2","v3"],D=["v4"],U={zero:0,one:1,two:2,few:3,many:4,other:5};class V{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=c.create("pluralResolver"),this.options.compatibilityJSON&&!D.includes(this.options.compatibilityJSON)||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=function(){const e={};return A.forEach((t=>{t.lngs.forEach((s=>{e[s]={numbers:t.nr,plurals:M[t.fc]}}))})),e}()}addRule(e,t){this.rules[e]=t}getRule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(w("dev"===e?"en":e),{type:t.ordinal?"ordinal":"cardinal"})}catch(e){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=this.getRule(e,t);return this.shouldUseIntlApi()?s&&s.resolvedOptions().pluralCategories.length>1:s&&s.numbers.length>1}getPluralFormsOfKey(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,s).map((e=>`${t}${e}`))}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=this.getRule(e,t);return s?this.shouldUseIntlApi()?s.resolvedOptions().pluralCategories.sort(((e,t)=>U[e]-U[t])).map((e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`)):s.numbers.map((s=>this.getSuffix(e,s,t))):[]}getSuffix(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getRule(e,s);return i?this.shouldUseIntlApi()?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:this.getSuffixRetroCompatible(i,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const s=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let i=e.numbers[s];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===i?i="plural":1===i&&(i=""));const n=()=>this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString();return"v1"===this.options.compatibilityJSON?1===i?"":"number"==typeof i?`_plural_${i.toString()}`:n():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?n():this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString()}shouldUseIntlApi(){return!P.includes(this.options.compatibilityJSON)}}function B(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=function(e,t,s){const i=b(e,s);return void 0!==i?i:b(t,s)}(e,t,s);return!o&&n&&"string"==typeof s&&(o=O(e,s,i),void 0===o&&(o=O(t,s,i))),o}class ${constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=c.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(e=>e),this.init(e)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const t=e.interpolation;this.escape=void 0!==t.escape?t.escape:L,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?v(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?v(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?v(t.nestingPrefix):t.nestingPrefixEscaped||v("$t("),this.nestingSuffix=t.nestingSuffix?v(t.nestingSuffix):t.nestingSuffixEscaped||v(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e&&e.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,s,i){let n,o,a;const r=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(e){return e.replace(/\$/g,"$$$$")}const h=e=>{if(e.indexOf(this.formatSeparator)<0){const n=B(t,r,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(n,void 0,s,{...i,...t,interpolationkey:e}):n}const n=e.split(this.formatSeparator),o=n.shift().trim(),a=n.join(this.formatSeparator).trim();return this.format(B(t,r,o,this.options.keySeparator,this.options.ignoreJSONStructure),a,s,{...i,...t,interpolationkey:o})};this.resetRegExp();const d=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,c=i&&i.interpolation&&void 0!==i.interpolation.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>l(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?l(this.escape(e)):l(e)}].forEach((t=>{for(a=0;n=t.regex.exec(e);){const s=n[1].trim();if(o=h(s),void 0===o)if("function"==typeof d){const t=d(e,n,i);o="string"==typeof t?t:""}else if(i&&Object.prototype.hasOwnProperty.call(i,s))o="";else{if(c){o=n[0];continue}this.logger.warn(`missed to pass in variable ${s} for interpolating ${e}`),o=""}else"string"==typeof o||this.useRawValueToEscape||(o=p(o));const r=t.safeValue(o);if(e=e.replace(n[0],r),c?(t.regex.lastIndex+=o.length,t.regex.lastIndex-=n[0].length):t.regex.lastIndex=0,a++,a>=this.maxReplaces)break}})),e}nest(e,t){let s,i,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function a(e,t){const s=this.nestingOptionsSeparator;if(e.indexOf(s)<0)return e;const i=e.split(new RegExp(`${s}[ ]*{`));let o=`{${i[1]}`;e=i[0],o=this.interpolate(o,n);const a=o.match(/'/g),r=o.match(/"/g);(a&&a.length%2==0&&!r||r.length%2!=0)&&(o=o.replace(/'/g,'"'));try{n=JSON.parse(o),t&&(n={...t,...n})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${s}${o}`}return delete n.defaultValue,e}for(;s=this.nestingRegexp.exec(e);){let r=[];n={...o},n=n.replace&&"string"!=typeof n.replace?n.replace:n,n.applyPostProcessor=!1,delete n.defaultValue;let l=!1;if(-1!==s[0].indexOf(this.formatSeparator)&&!/{.*}/.test(s[1])){const e=s[1].split(this.formatSeparator).map((e=>e.trim()));s[1]=e.shift(),r=e,l=!0}if(i=t(a.call(this,s[1].trim(),n),n),i&&s[0]===e&&"string"!=typeof i)return i;"string"!=typeof i&&(i=p(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),i=""),l&&(i=r.reduce(((e,t)=>this.format(e,t,o.lng,{...o,interpolationkey:s[1].trim()})),i.trim())),e=e.replace(s[0],i),this.regexp.lastIndex=0}return e}}function z(e){const t={};return function(s,i,n){const o=i+JSON.stringify(n);let a=t[o];return a||(a=e(w(i),n),t[o]=a),a(s)}}class j{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=c.create("formatter"),this.options=e,this.formats={number:z(((e,t)=>{const s=new Intl.NumberFormat(e,{...t});return e=>s.format(e)})),currency:z(((e,t)=>{const s=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>s.format(e)})),datetime:z(((e,t)=>{const s=new Intl.DateTimeFormat(e,{...t});return e=>s.format(e)})),relativetime:z(((e,t)=>{const s=new Intl.RelativeTimeFormat(e,{...t});return e=>s.format(e,t.range||"day")})),list:z(((e,t)=>{const s=new Intl.ListFormat(e,{...t});return e=>s.format(e)}))},this.init(e)}init(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=z(t)}format(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return t.split(this.formatSeparator).reduce(((e,t)=>{const{formatName:n,formatOptions:o}=function(e){let t=e.toLowerCase().trim();const s={};if(e.indexOf("(")>-1){const i=e.split("(");t=i[0].toLowerCase().trim();const n=i[1].substring(0,i[1].length-1);"currency"===t&&n.indexOf(":")<0?s.currency||(s.currency=n.trim()):"relativetime"===t&&n.indexOf(":")<0?s.range||(s.range=n.trim()):n.split(";").forEach((e=>{if(!e)return;const[t,...i]=e.split(":"),n=i.join(":").trim().replace(/^'+|'+$/g,"");s[t.trim()]||(s[t.trim()]=n),"false"===n&&(s[t.trim()]=!1),"true"===n&&(s[t.trim()]=!0),isNaN(n)||(s[t.trim()]=parseInt(n,10))}))}return{formatName:t,formatOptions:s}}(t);if(this.formats[n]){let t=e;try{const a=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},r=a.locale||a.lng||i.locale||i.lng||s;t=this.formats[n](e,r,{...o,...i,...a})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${n}`),e}),e)}}class G extends u{constructor(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=s,this.languageUtils=s.languageUtils,this.options=i,this.logger=c.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(s,i.backend,i)}queueLoad(e,t,s,i){const n={},o={},a={},r={};return e.forEach((e=>{let i=!0;t.forEach((t=>{const a=`${e}|${t}`;!s.reload&&this.store.hasResourceBundle(e,t)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===o[a]&&(o[a]=!0):(this.state[a]=1,i=!1,void 0===o[a]&&(o[a]=!0),void 0===n[a]&&(n[a]=!0),void 0===r[t]&&(r[t]=!0)))})),i||(a[e]=!0)})),(Object.keys(n).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(n),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(r)}}loaded(e,t,s){const i=e.split("|"),n=i[0],o=i[1];t&&this.emit("failedLoading",n,o,t),s&&this.store.addResourceBundle(n,o,s,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2;const a={};this.queue.forEach((s=>{!function(e,t,s,i){const{obj:n,k:o}=m(e,t,Object);n[o]=n[o]||[],n[o].push(s)}(s.loaded,[n],o),function(e,t){void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)}(s,e),t&&s.errors.push(t),0!==s.pendingCount||s.done||(Object.keys(s.loaded).forEach((e=>{a[e]||(a[e]={});const t=s.loaded[e];t.length&&t.forEach((t=>{void 0===a[e][t]&&(a[e][t]=!0)}))})),s.done=!0,s.errors.length?s.callback(s.errors):s.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((e=>!e.done))}read(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:s,tried:i,wait:n,callback:o});this.readingCalls++;const a=(a,r)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}a&&r&&i<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,s,i+1,2*n,o)}),n):o(a,r)},r=this.backend[s].bind(this.backend);if(2!==r.length)return r(e,t,a);try{const s=r(e,t);s&&"function"==typeof s.then?s.then((e=>a(null,e))).catch(a):a(null,s)}catch(e){a(e)}}prepareLoading(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);const n=this.queueLoad(e,t,s,i);if(!n.toLoad.length)return n.pending.length||i(),null;n.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,s){this.prepareLoading(e,t,{},s)}reload(e,t,s){this.prepareLoading(e,t,{reload:!0},s)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=e.split("|"),i=s[0],n=s[1];this.read(i,n,"read",void 0,void 0,((s,o)=>{s&&this.logger.warn(`${t}loading namespace ${n} for language ${i} failed`,s),!s&&o&&this.logger.log(`${t}loaded namespace ${n} for language ${i}`,o),this.loaded(e,s,o)}))}saveMissing(e,t,s,i,n){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t))this.logger.warn(`did not save key "${s}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(null!=s&&""!==s){if(this.backend&&this.backend.create){const r={...o,isUpdate:n},l=this.backend.create.bind(this.backend);if(l.length<6)try{let n;n=5===l.length?l(e,t,s,i,r):l(e,t,s,i),n&&"function"==typeof n.then?n.then((e=>a(null,e))).catch(a):a(null,n)}catch(e){a(e)}else l(e,t,s,i,a,r)}e&&e[0]&&this.store.addResource(e[0],t,s,i)}}}function F(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){let t={};if("object"==typeof e[1]&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const s=e[3]||e[2];Object.keys(s).forEach((e=>{t[e]=s[e]}))}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function H(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function K(){}class W extends u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var s;if(super(),this.options=H(e),this.services={},this.logger=c,this.modules={external:[]},s=this,Object.getOwnPropertyNames(Object.getPrototypeOf(s)).forEach((e=>{"function"==typeof s[e]&&(s[e]=s[e].bind(s))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof t&&(s=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const i=F();function n(e){return e?"function"==typeof e?new e:e:null}if(this.options={...i,...this.options,...H(t)},"v1"!==this.options.compatibilityAPI&&(this.options.interpolation={...i.interpolation,...this.options.interpolation}),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){let t;this.modules.logger?c.init(n(this.modules.logger),this.options):c.init(null,this.options),this.modules.formatter?t=this.modules.formatter:"undefined"!=typeof Intl&&(t=j);const s=new T(this.options);this.store=new k(this.options.resources,this.options);const o=this.services;o.logger=c,o.resourceStore=this.store,o.languageUtils=s,o.pluralResolver=new V(s,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!t||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(o.formatter=n(t),o.formatter.init(o,this.options),this.options.interpolation.format=o.formatter.format.bind(o.formatter)),o.interpolator=new $(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new G(n(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",(function(t){for(var s=arguments.length,i=new Array(s>1?s-1:0),n=1;n<s;n++)i[n-1]=arguments[n];e.emit(t,...i)})),this.modules.languageDetector&&(o.languageDetector=n(this.modules.languageDetector),o.languageDetector.init&&o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=n(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new R(this.services,this.options),this.translator.on("*",(function(t){for(var s=arguments.length,i=new Array(s>1?s-1:0),n=1;n<s;n++)i[n-1]=arguments[n];e.emit(t,...i)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,s||(s=K),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((t=>{this[t]=function(){return e.store[t](...arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((t=>{this[t]=function(){return e.store[t](...arguments),e}}));const o=g(),a=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(t),s(e,t)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initImmediate?a():setTimeout(a,0),o}loadResources(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;const s="string"==typeof e?e:this.language;if("function"==typeof e&&(t=e),!this.options.resources||this.options.partialBundledLanguages){if(s&&"cimode"===s.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return t();const e=[],i=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};s?i(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>i(e))),this.options.preload&&this.options.preload.forEach((e=>i(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),t(e)}))}else t(null)}reloadResources(e,t,s){const i=g();return e||(e=this.languages),t||(t=this.options.ns),s||(s=K),this.services.backendConnector.reload(e,t,(e=>{i.resolve(),s(e)})),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&C.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(e,t){var s=this;this.isLanguageChangingTo=e;const i=g();this.emit("languageChanging",e);const n=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},o=(e,o)=>{o?(n(o),this.translator.changeLanguage(o),this.isLanguageChangingTo=void 0,this.emit("languageChanged",o),this.logger.log("languageChanged",o)):this.isLanguageChangingTo=void 0,i.resolve((function(){return s.t(...arguments)})),t&&t(e,(function(){return s.t(...arguments)}))},a=t=>{e||t||!this.services.languageDetector||(t=[]);const s="string"==typeof t?t:this.services.languageUtils.getBestMatchFromCodes(t);s&&(this.language||n(s),this.translator.language||this.translator.changeLanguage(s),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(s)),this.loadResources(s,(e=>{o(e,s)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e):a(this.services.languageDetector.detect()),i}getFixedT(e,t,s){var i=this;const n=function(e,t){let o;if("object"!=typeof t){for(var a=arguments.length,r=new Array(a>2?a-2:0),l=2;l<a;l++)r[l-2]=arguments[l];o=i.options.overloadTranslationOptionHandler([e,t].concat(r))}else o={...t};o.lng=o.lng||n.lng,o.lngs=o.lngs||n.lngs,o.ns=o.ns||n.ns,o.keyPrefix=o.keyPrefix||s||n.keyPrefix;const h=i.options.keySeparator||".";let d;return d=o.keyPrefix&&Array.isArray(e)?e.map((e=>`${o.keyPrefix}${h}${e}`)):o.keyPrefix?`${o.keyPrefix}${h}${e}`:e,i.t(d,o)};return"string"==typeof e?n.lng=e:n.lngs=e,n.ns=t,n.keyPrefix=s,n}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=t.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,n=this.languages[this.languages.length-1];if("cimode"===s.toLowerCase())return!0;const o=(e,t)=>{const s=this.services.backendConnector.state[`${e}|${t}`];return-1===s||2===s};if(t.precheck){const e=t.precheck(this,o);if(void 0!==e)return e}return!(!this.hasResourceBundle(s,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!o(s,e)||i&&!o(n,e)))}loadNamespaces(e,t){const s=g();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{s.resolve(),t&&t(e)})),s):(t&&t(),Promise.resolve())}loadLanguages(e,t){const s=g();"string"==typeof e&&(e=[e]);const i=this.options.preload||[],n=e.filter((e=>i.indexOf(e)<0));return n.length?(this.options.preload=i.concat(n),this.loadResources((e=>{s.resolve(),t&&t(e)})),s):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services&&this.services.languageUtils||new T(F());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new W(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;const s=e.forkResourceStore;s&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},n=new W(i);return void 0===e.debug&&void 0===e.prefix||(n.logger=n.logger.clone(e)),["store","services","language"].forEach((e=>{n[e]=this[e]})),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},s&&(n.store=new k(this.store.data,i),n.services.resourceStore=n.store),n.translator=new R(n.services,i),n.translator.on("*",(function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];n.emit(e,...s)})),n.init(i,t),n.translator.options=i,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const J=W.createInstance();let q;J.createInstance=W.createInstance,J.createInstance,J.dir,J.init,J.loadResources,J.reloadResources,J.use,J.changeLanguage,J.getFixedT,J.t,J.exists,J.setDefaultNamespace,J.hasLoadedNamespace,J.loadNamespaces,J.loadLanguages;const Y=(e,t)=>{switch(e){case"set":localStorage.setItem("ring",t);break;case"delete":localStorage.removeItem("ring")}return localStorage.getItem("ring")},Q=e=>{ee.configureSounds({ring:e})};let Z,X;ee.onBackgroundMessage=e=>{switch(e.value){case"ring":(e=>{const t=e.data;if("original"===t)ee.resetSounds(),Y("delete");else{const e=`${q}/sounds/${t}`;Y("set",e),Q(e)}})(e);break;case"config":const t=Y();ee.sendMessageToIframe({value:"config",ring:t})}},(async()=>{await ee.initialize();const e=ee.getContext();q=e.app.extra.baseUrl;const t=Y();t&&Q(t),console.log("ring background - background launched")})();const ee=new n,te=document.getElementById("ring"),se=document.getElementById("playButton"),ie=document.getElementById("stopButton"),ne={original:"Reset to original","iphone.mp3":"Iphone","iphone6.mp3":"Iphone 6","landline1.wav":"Landline 1","landline2.wav":"Landline 2","marimba.wav":"Marimba 1","marimba.mp3":"Marimba 2","ring3.wav":"Ring 3","ring4.wav":"Ring 4","ring5.wav":"Ring 5","dark_side_ringtone.mp3":"Star Wars","bird2.mp3":"Bird","sf-oiseau-24.mp3":"Bird 1","oiseau2.mp3":"Bird 2","sf_oiseau_seul_01.mp3":"Bird 3","sf_oiseaux.mp3":"Bird 4","sf_canari.mp3":"Canary","zelda_lost_woods.mp3":"Zelda 1","hedwigs.mp3":"Harry Potter","lg_bubble.mp3":"Bubble","marimba.wav":"Marimba","stranger_things.mp3":"Stranger Things","breaking_bad.mp3":"Breaking Bad","huawei.mp3":"Huawei","lg_peanut.mp3":"Peanut","xylo.mp3":"Xylophone"};ee.onIframeMessage=e=>{if(e.ring){const t=e.ring.split("/").pop();te.value=t}};const oe=()=>{Z&&Z.pause()};(async()=>{await ee.initialize();const e=ee.getContext(),t=e.app.locale;X=e.app.extra.baseUrl,((e,t)=>{const s=document.getElementById("ring");for(const t in e){const i=document.createElement("option");i.text=e[t],i.value=t,s.add(i)}})(ne),ring.addEventListener("change",(function(){const e=te.value;ee.sendMessageToBackground({value:"ring",data:e}),oe()})),se.addEventListener("click",(()=>{const e=te.value,t=`${X}/sounds/${e}`;oe(),(e=>{Z=new Audio(e),Z.play()})(t)})),ie.addEventListener("click",(()=>{oe()})),ee.sendMessageToBackground({value:"config"}),await J.init({lng:t,fallbackLng:"en",debug:!1,resources:{en:{translation:{choose_ring:"Select your ringtone"}},fr:{translation:{choose_ring:"Choisissez votre sonnerie"}}}}),document.getElementById("choose-ring").innerHTML=J.t("choose_ring")})()})()})();